package com.csd.repointel.model;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * Model representing a dependency with its vulnerability assessment.
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class DependencyVulnerability {
    private String groupId;
    private String artifactId;
    private String currentVersion;
    private VulnerabilityStatus status;
    private String cveId;
    private String affectedRange;
    private VulnerabilitySeverity severity;
    private double cvssScore;
    private String description;
    private String recommendedVersion;
    private String latestVersion;
    private int daysOld;                    // How old is the current version
    private boolean hasNewerVersion;
    private String fixAvailable;            // "yes", "no", "partial"
    
    /**
     * Get status emoji for display.
     */
    public String getStatusEmoji() {
        return status != null ? status.getEmoji() : "â“";
    }

    /**
     * Get severity color code for UI.
     */
    public String getSeverityColor() {
        return severity != null ? severity.getColorCode() : "#6c757d";
    }

    /**
     * Check if this dependency is vulnerable.
     */
    public boolean isVulnerable() {
        return status == VulnerabilityStatus.VULNERABLE;
    }

    /**
     * Check if this dependency is outdated.
     */
    public boolean isOutdated() {
        return hasNewerVersion && daysOld > 90;
    }
}
