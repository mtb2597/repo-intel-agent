package com.csd.repointel.model;

/**
 * Enum representing vulnerability severity levels based on CVSS scoring.
 */
public enum VulnerabilitySeverity {
    CRITICAL("Critical", 9.0, 10.0, "#dc3545"),  // Red
    HIGH("High", 7.0, 8.9, "#fd7e14"),           // Orange
    MEDIUM("Medium", 4.0, 6.9, "#ffc107"),       // Yellow
    LOW("Low", 0.1, 3.9, "#17a2b8"),             // Blue
    NONE("None", 0.0, 0.0, "#28a745"),           // Green
    UNKNOWN("Unknown", 0.0, 0.0, "#6c757d");     // Gray

    private final String displayName;
    private final double minScore;
    private final double maxScore;
    private final String colorCode;

    VulnerabilitySeverity(String displayName, double minScore, double maxScore, String colorCode) {
        this.displayName = displayName;
        this.minScore = minScore;
        this.maxScore = maxScore;
        this.colorCode = colorCode;
    }

    public String getDisplayName() {
        return displayName;
    }

    public double getMinScore() {
        return minScore;
    }

    public double getMaxScore() {
        return maxScore;
    }

    public String getColorCode() {
        return colorCode;
    }

    public static VulnerabilitySeverity fromScore(double cvssScore) {
        if (cvssScore >= 9.0) return CRITICAL;
        if (cvssScore >= 7.0) return HIGH;
        if (cvssScore >= 4.0) return MEDIUM;
        if (cvssScore > 0.0) return LOW;
        return NONE;
    }

    public static VulnerabilitySeverity fromString(String severity) {
        if (severity == null) return UNKNOWN;
        try {
            return valueOf(severity.toUpperCase());
        } catch (IllegalArgumentException e) {
            return UNKNOWN;
        }
    }
}
